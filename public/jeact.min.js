!function(t){function n(o){if(e[o])return e[o].exports;var a=e[o]={exports:{},id:o,loaded:!1};return t[o].call(a.exports,a,a.exports,n),a.loaded=!0,a.exports}var e={};return n.m=t,n.c=e,n.p="",n(0)}([function(t,n){window.j=function(){var t={};return t.timeout=500,t.Dictionary=function(){this.data=new Array,this.key=0,this.add=function(t){return this.key++,this.data[this.key]=t,this.key},this.get=function(t){return this.data[t]},this.del=function(t){delete this.data[t]},this.run=function(t,n){var e=this.data[t];return this.del(t),"function"==typeof e?e(n):void 0}},t.WsState=function(){return"undefined"!=typeof t.ws&&1==t.ws.readyState},t.Connections=function(n,e){if(n||(n=[{ip:document.domain?document.domain:"127.0.0.1",port:88}]),"object"!=typeof n||"function"!=typeof e)throw"partment ill";var o=n.pop();console.log(o),o?(t.ip=o.ip,t.port=o.port,t.Connection(function(o){if(o.State)e(o);else{var a=n.pop();a?(n.push(a),t.Connections(n,e)):e(o)}})):e({State:!1,code:25,Reason:"参数错误"})},t.Connection=function(n){var e=function(t){"function"==typeof n&&(n(t),n=null)};if(t.WsState())return void e({State:!0,code:3,Reason:"已连接",addr:t.ws.url});try{var o=new WebSocket("ws://"+t.ip+":"+t.port);o.onopen=function(n){t.ws=o,e({State:!0,code:1,Reason:"连接成功",addr:o.url})},o.onmessage=function(n){var e=n.data||"{}";try{e=JSON.parse(e)}catch(o){e={}}if(e.MsgId)try{t.callmap.run(e.MsgId,e)}catch(o){}else alert("自定义消息："+n.data)},o.onclose=function(t){e({State:!1,code:21,Reason:"取消连接",addr:o.url})},o.onerror=function(t){e({State:!1,code:22,Reason:"连接错误",addr:o.url})}}catch(a){e({State:!1,code:23,Reason:"连接异常"+a.message,addr:o.url})}setTimeout(function(){e({State:!1,code:24,Reason:"连接超时",addr:o.url})},t.timeout)},t.callmap=new t.Dictionary,t.get=function(n,e,o){if("function"==typeof o){if(!WebSocket)return void o({State:!1,Reason:"您的设备不支持"});var a=t.callmap.add(o);t.send(n,e,a)}},t.send=function(n,e,o){e={DllName:n,Data:e,State:!1,Reason:"Untreated"},o&&(e.MsgId=o),e=JSON.stringify(e),t.Connections(t.ips,function(n){n.State?(t.ws.send(e),setTimeout(function(){t.callmap.run(o,{State:!1,Reason:"请求连接超时"})},t.timeout)):(e.Reason=n.msg,t.callmap.run(o,n))})},t.parameter=function(){var t=location.search,n=new Object;if(-1!=t.indexOf("?")){var e=t.substr(1);strs=e.split("&");for(var o=0;o<strs.length;o++)n[strs[o].split("=")[0]]=unescape(strs[o].split("=")[1])}return n}(),t}()}]);